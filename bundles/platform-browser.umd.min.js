/**
 * @license Mojiito v2.0.0-alpha.3-47c2852
 * (c) 2010-2017 Thomas Pink
 * License: MIT
 */
!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("mojiito-core")):"function"==typeof define&&define.amd?define(["exports","mojiito-core"],factory):factory((global.mj=global.mj||{},global.mj.platformBrowser=global.mj.platformBrowser||{}),global.mj.core)}(this,function(exports,mojiitoCore){"use strict";function getClassName(klass){return klass.name?klass.name:/^function\s+([\w\$]+)\s*\(/.exec(this.toString())[1]}function stringify(token){if("string"==typeof token)return token;if(void 0===token||null===token)return""+token;if(token.name)return token.name;if(token.overriddenName)return token.overriddenName;if("function"==typeof token)return getClassName(token);if(token instanceof HTMLElement){var parts=token.toString().match(/\w+/g);if(parts&&parts.length)return parts[parts.length-1]}var res=token.toString(),newLineIndex=res.indexOf("\n");return-1===newLineIndex?res:res.substring(0,newLineIndex)}function isPresent(obj){return null!=obj}function isWhitespace(code){return code>=$TAB&&$SPACE>=code||code==$NBSP}function isDigit(code){return code>=$0&&$9>=code}function isAsciiLetter(code){return code>=$a&&$z>=code||code>=$A&&$Z>=code}function newCharacterToken(index,code){return new Token$$1(index,TokenType.Character,code,String.fromCharCode(code))}function newIdentifierToken(index,text){return new Token$$1(index,TokenType.Identifier,0,text)}function newKeywordToken(index,text){return new Token$$1(index,TokenType.Keyword,0,text)}function newOperatorToken(index,text){return new Token$$1(index,TokenType.Operator,0,text)}function newStringToken(index,text){return new Token$$1(index,TokenType.String,0,text)}function newNumberToken(index,n){return new Token$$1(index,TokenType.Number,n,"")}function newErrorToken(index,message){return new Token$$1(index,TokenType.Error,0,message)}function isIdentifierStart(code){return code>=$a&&$z>=code||code>=$A&&$Z>=code||code==$_||code==$$}function isIdentifierPart(code){return isAsciiLetter(code)||isDigit(code)||code==$_||code==$$}function isExponentStart(code){return code==$e||code==$E}function isExponentSign(code){return code==$MINUS||code==$PLUS}function unescape(code){switch(code){case $n:return $LF;case $f:return $FF;case $r:return $CR;case $t:return $TAB;case $v:return $VTAB;default:return code}}function unsupported(type,name,expression){throw new Error(type+" is not yet supported: "+name+'="'+expression+'"')}function getGlobalEventTarget(target){return"window"===target?window:"document"===target?this.document:"body"===target?this.document.body:void 0}var globalScope,__extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),ListWrapper=function(){function ListWrapper(){}return ListWrapper.findLast=function(arr,condition){for(var i=arr.length-1;i>=0;i--)if(condition(arr[i]))return arr[i];return null},ListWrapper.removeAll=function(list,items){for(var i=0;i<items.length;++i){var index=list.indexOf(items[i]);index>-1&&list.splice(index,1)}},ListWrapper.remove=function(list,el){var index=list.indexOf(el);return index>-1?(list.splice(index,1),!0):!1},ListWrapper.equals=function(a,b){if(a.length!=b.length)return!1;for(var i=0;i<a.length;++i)if(a[i]!==b[i])return!1;return!0},ListWrapper.flatten=function(list){return list.reduce(function(flat,item){var flatItem=Array.isArray(item)?ListWrapper.flatten(item):item;return flat.concat(flatItem)},[])},ListWrapper.forEach=function(list,callback){for(var i=0,max=list.length;max>i;i++)callback.call(callback,list[i],i)},ListWrapper}(),_SELECTOR_REGEXP=new RegExp("(\\:not\\()|([-\\w]+)|(?:\\.([-\\w]+))|(?:\\[([-.\\w*]+)(?:=([^\\]]*))?\\])|(\\))|(\\s*,\\s*)","g"),CssSelector=function(){function CssSelector(){this.element=null,this.classNames=[],this.attrs=[],this.notSelectors=[]}return CssSelector.fromElement=function(element){var selector=new CssSelector;return selector.setElement(element.tagName.toLocaleLowerCase()),ListWrapper.forEach(element.attributes,function(attr){"class"!==attr.name.toLocaleLowerCase()&&selector.addAttribute(attr.name.trim(),attr.value.trim())}),ListWrapper.forEach(element.classList,function(c){return selector.addClassName(c)}),selector},CssSelector.parse=function(selector){var match,results=[],_addResult=function(res,cssSel){cssSel.notSelectors.length>0&&!cssSel.element&&0==cssSel.classNames.length&&0==cssSel.attrs.length&&(cssSel.element="*"),res.push(cssSel)},cssSelector=new CssSelector,current=cssSelector,inNot=!1;for(_SELECTOR_REGEXP.lastIndex=0;match=_SELECTOR_REGEXP.exec(selector);){if(match[1]){if(inNot)throw new Error("Nesting :not is not allowed in a selector");inNot=!0,current=new CssSelector,cssSelector.notSelectors.push(current)}if(match[2]&&current.setElement(match[2]),match[3]&&current.addClassName(match[3]),match[4]&&current.addAttribute(match[4],match[5]),match[6]&&(inNot=!1,current=cssSelector),match[7]){if(inNot)throw new Error("Multiple selectors in :not are not supported");_addResult(results,cssSelector),cssSelector=current=new CssSelector}}return _addResult(results,cssSelector),results},CssSelector.prototype.isElementSelector=function(){return this.hasElementSelector()&&0==this.classNames.length&&0==this.attrs.length&&0===this.notSelectors.length},CssSelector.prototype.hasElementSelector=function(){return!!this.element},CssSelector.prototype.setElement=function(element){void 0===element&&(element=null),this.element=element},CssSelector.prototype.addAttribute=function(name,value){void 0===value&&(value=""),this.attrs.push(name,value&&value.toLowerCase()||"")},CssSelector.prototype.addClassName=function(name){this.classNames.push(name.toLowerCase())},CssSelector.prototype.toString=function(){var res=this.element||"";if(this.classNames&&this.classNames.forEach(function(klass){return res+="."+klass}),this.attrs)for(var i=0;i<this.attrs.length;i+=2){var name=this.attrs[i],value=this.attrs[i+1];res+="["+name+(value?"="+value:"")+"]"}return this.notSelectors.forEach(function(notSelector){return res+=":not("+notSelector+")"}),res},CssSelector}(),SelectorMatcher=function(){function SelectorMatcher(){this._elementMap=new Map,this._elementPartialMap=new Map,this._classMap=new Map,this._classPartialMap=new Map,this._attrValueMap=new Map,this._attrValuePartialMap=new Map,this._listContexts=[]}return SelectorMatcher.createNotMatcher=function(notSelectors){var notMatcher=new SelectorMatcher;return notMatcher.addSelectables(notSelectors,null),notMatcher},SelectorMatcher.prototype.addSelectables=function(cssSelectors,callbackCtxt){var listContext=null;cssSelectors.length>1&&(listContext=new SelectorListContext(cssSelectors),this._listContexts.push(listContext));for(var i=0;i<cssSelectors.length;i++)this._addSelectable(cssSelectors[i],callbackCtxt,listContext)},SelectorMatcher.prototype._addSelectable=function(cssSelector,callbackCtxt,listContext){var matcher=this,element=cssSelector.element,classNames=cssSelector.classNames,attrs=cssSelector.attrs,selectable=new SelectorContext(cssSelector,callbackCtxt,listContext);if(element){var isTerminal=0===attrs.length&&0===classNames.length;isTerminal?this._addTerminal(matcher._elementMap,element,selectable):matcher=this._addPartial(matcher._elementPartialMap,element)}if(classNames)for(var i=0;i<classNames.length;i++){var isTerminal=0===attrs.length&&i===classNames.length-1,className=classNames[i];isTerminal?this._addTerminal(matcher._classMap,className,selectable):matcher=this._addPartial(matcher._classPartialMap,className)}if(attrs)for(var i=0;i<attrs.length;i+=2){var isTerminal=i===attrs.length-2,name=attrs[i],value=attrs[i+1];if(isTerminal){var terminalMap=matcher._attrValueMap,terminalValuesMap=terminalMap.get(name);terminalValuesMap||(terminalValuesMap=new Map,terminalMap.set(name,terminalValuesMap)),this._addTerminal(terminalValuesMap,value,selectable)}else{var partialMap=matcher._attrValuePartialMap,partialValuesMap=partialMap.get(name);partialValuesMap||(partialValuesMap=new Map,partialMap.set(name,partialValuesMap)),matcher=this._addPartial(partialValuesMap,value)}}},SelectorMatcher.prototype._addTerminal=function(map,name,selectable){var terminalList=map.get(name);terminalList||(terminalList=[],map.set(name,terminalList)),terminalList.push(selectable)},SelectorMatcher.prototype._addPartial=function(map,name){var matcher=map.get(name);return matcher||(matcher=new SelectorMatcher,map.set(name,matcher)),matcher},SelectorMatcher.prototype.match=function(cssSelector,matchedCallback){void 0===matchedCallback&&(matchedCallback=function(){});for(var result=!1,element=cssSelector.element,classNames=cssSelector.classNames,attrs=cssSelector.attrs,i=0;i<this._listContexts.length;i++)this._listContexts[i].alreadyMatched=!1;if(result=this._matchTerminal(this._elementMap,element,cssSelector,matchedCallback)||result,result=this._matchPartial(this._elementPartialMap,element,cssSelector,matchedCallback)||result,classNames)for(var i=0;i<classNames.length;i++){var className=classNames[i];result=this._matchTerminal(this._classMap,className,cssSelector,matchedCallback)||result,result=this._matchPartial(this._classPartialMap,className,cssSelector,matchedCallback)||result}if(attrs)for(var i=0;i<attrs.length;i+=2){var name=attrs[i],value=attrs[i+1],terminalValuesMap=this._attrValueMap.get(name);value&&(result=this._matchTerminal(terminalValuesMap,"",cssSelector,matchedCallback)||result),result=this._matchTerminal(terminalValuesMap,value,cssSelector,matchedCallback)||result;var partialValuesMap=this._attrValuePartialMap.get(name);value&&(result=this._matchPartial(partialValuesMap,"",cssSelector,matchedCallback)||result),result=this._matchPartial(partialValuesMap,value,cssSelector,matchedCallback)||result}return result},SelectorMatcher.prototype._matchTerminal=function(map,name,cssSelector,matchedCallback){if(!map||"string"!=typeof name)return!1;var selectables=map.get(name)||[],starSelectables=map.get("*");if(starSelectables&&(selectables=selectables.concat(starSelectables)),0===selectables.length)return!1;for(var selectable,result=!1,i=0;i<selectables.length;i++)selectable=selectables[i],result=selectable.finalize(cssSelector,matchedCallback)||result;return result},SelectorMatcher.prototype._matchPartial=function(map,name,cssSelector,matchedCallback){if(!map||"string"!=typeof name)return!1;var nestedSelector=map.get(name);return nestedSelector?nestedSelector.match(cssSelector,matchedCallback):!1},SelectorMatcher}(),SelectorListContext=function(){function SelectorListContext(selectors){this.selectors=selectors,this.alreadyMatched=!1}return SelectorListContext}(),SelectorContext=function(){function SelectorContext(selector,cbContext,listContext){this.selector=selector,this.cbContext=cbContext,this.listContext=listContext,this.notSelectors=selector.notSelectors}return SelectorContext.prototype.finalize=function(cssSelector,callback){var result=!0;if(this.notSelectors.length>0&&(!this.listContext||!this.listContext.alreadyMatched)){var notMatcher=SelectorMatcher.createNotMatcher(this.notSelectors);result=!notMatcher.match(cssSelector,null)}return!result||!callback||this.listContext&&this.listContext.alreadyMatched||(this.listContext&&(this.listContext.alreadyMatched=!0),callback(this.selector,this.cbContext)),result},SelectorContext}(),BaseError=function(_super){function BaseError(message){var _this=_super.call(this,message)||this,nativeError=new Error(message);return _this._nativeError=nativeError,_this}return __extends(BaseError,_super),Object.defineProperty(BaseError.prototype,"message",{get:function(){return this._nativeError.message},set:function(message){this._nativeError.message=message},enumerable:!0,configurable:!0}),Object.defineProperty(BaseError.prototype,"name",{get:function(){return this._nativeError.name},enumerable:!0,configurable:!0}),Object.defineProperty(BaseError.prototype,"stack",{get:function(){return this._nativeError.stack},set:function(value){this._nativeError.stack=value},enumerable:!0,configurable:!0}),BaseError.prototype.toString=function(){return this._nativeError.toString()},BaseError}(Error),WrappedError=function(_super){function WrappedError(message,error){var _this=_super.call(this,message+" caused by: "+(error instanceof Error?error.message:error))||this;return _this.originalError=error,_this}return __extends(WrappedError,_super),Object.defineProperty(WrappedError.prototype,"stack",{get:function(){return(this.originalError instanceof Error?this.originalError:this._nativeError).stack},enumerable:!0,configurable:!0}),WrappedError}(BaseError);globalScope="undefined"==typeof window?"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:global:window;var NumberWrapper=function(){function NumberWrapper(){}return NumberWrapper.parseIntAutoRadix=function(text){var result=parseInt(text);if(isNaN(result))throw new Error("Invalid integer literal when parsing "+text);return result},NumberWrapper.isNumeric=function(value){return!isNaN(value-parseFloat(value))},NumberWrapper}(),DomVisitor=function(){function DomVisitor(components){var _this=this;this._selectorMatcher=new SelectorMatcher,this._componentsIndex=new Map,components.forEach(function(component,index){var selector=CssSelector.parse(component.selector);_this._selectorMatcher.addSelectables(selector,component),_this._componentsIndex.set(component,index)})}return DomVisitor.prototype.visitElement=function(element,context){var matchingComponent,elementCssSelector=CssSelector.fromElement(element);if(this._selectorMatcher.match(elementCssSelector,function(selector,component){if(matchingComponent)throw new MultipleComponentsOnElementError([matchingComponent.type,component.type]);matchingComponent=component}),!matchingComponent)return context;var viewDef=matchingComponent.viewDefinitionFactory(),view=mojiitoCore.createView(context.root,context,element,viewDef);return ListWrapper.forEach(element.attributes,function(){}),view},DomVisitor.prototype.visitAttribute=function(){},DomVisitor.prototype.visitText=function(){},DomVisitor.prototype.visitComment=function(){},DomVisitor}(),ParseError=function(_super){function ParseError(error){return _super.call(this,"Parse Error",error)||this}return __extends(ParseError,_super),ParseError}(WrappedError),MultipleComponentsOnElementError=function(_super){function MultipleComponentsOnElementError(components){var _this=this,names=components.map(function(c){return stringify(c)}).join(", ");return _this=_super.call(this,"The selectors of the components "+names+" are matching the same DOM Element. Only one component per element is allowed.")||this}return __extends(MultipleComponentsOnElementError,_super),MultipleComponentsOnElementError}(ParseError),$EOF=0,$TAB=9,$LF=10,$VTAB=11,$FF=12,$CR=13,$SPACE=32,$BANG=33,$DQ=34,$HASH=35,$$=36,$PERCENT=37,$AMPERSAND=38,$SQ=39,$LPAREN=40,$RPAREN=41,$STAR=42,$PLUS=43,$COMMA=44,$MINUS=45,$PERIOD=46,$SLASH=47,$COLON=58,$SEMICOLON=59,$LT=60,$EQ=61,$GT=62,$QUESTION=63,$0=48,$9=57,$A=65,$E=69,$Z=90,$LBRACKET=91,$BACKSLASH=92,$RBRACKET=93,$CARET=94,$_=95,$a=97,$e=101,$f=102,$n=110,$r=114,$t=116,$u=117,$v=118,$z=122,$LBRACE=123,$BAR=124,$RBRACE=125,$NBSP=160,TokenType={};TokenType.Character=0,TokenType.Identifier=1,TokenType.Keyword=2,TokenType.String=3,TokenType.Operator=4,TokenType.Number=5,TokenType.Error=6,TokenType[TokenType.Character]="Character",TokenType[TokenType.Identifier]="Identifier",TokenType[TokenType.Keyword]="Keyword",TokenType[TokenType.String]="String",TokenType[TokenType.Operator]="Operator",TokenType[TokenType.Number]="Number",TokenType[TokenType.Error]="Error";var KEYWORDS=["var","let","null","undefined","true","false","if","else","this"],ExpressionParser$$1=function(){function ExpressionParser$$1(){}return ExpressionParser$$1.prototype.tokenize=function(text){for(var scanner=new Scanner(text),tokens=[],token=scanner.scanToken();null!=token;)tokens.push(token),token=scanner.scanToken();return tokens},ExpressionParser$$1.prototype.parse=function(text){return new Expression(this.tokenize(text))},ExpressionParser$$1}();ExpressionParser$$1.decorators=[{type:mojiitoCore.Injectable}],ExpressionParser$$1.ctorParameters=function(){return[]};var Token$$1=function(){function Token$$1(index,type,numValue,strValue){this.index=index,this.type=type,this.numValue=numValue,this.strValue=strValue}return Token$$1.prototype.isCharacter=function(code){return this.type==TokenType.Character&&this.numValue==code},Token$$1.prototype.isNumber=function(){return this.type==TokenType.Number},Token$$1.prototype.isString=function(){return this.type==TokenType.String},Token$$1.prototype.isOperator=function(operater){return this.type==TokenType.Operator&&this.strValue==operater},Token$$1.prototype.isIdentifier=function(){return this.type==TokenType.Identifier},Token$$1.prototype.isKeyword=function(){return this.type==TokenType.Keyword},Token$$1.prototype.isKeywordLet=function(){return this.type==TokenType.Keyword&&"let"==this.strValue},Token$$1.prototype.isKeywordNull=function(){return this.type==TokenType.Keyword&&"null"==this.strValue},Token$$1.prototype.isKeywordUndefined=function(){return this.type==TokenType.Keyword&&"undefined"==this.strValue},Token$$1.prototype.isKeywordTrue=function(){return this.type==TokenType.Keyword&&"true"==this.strValue},Token$$1.prototype.isKeywordFalse=function(){return this.type==TokenType.Keyword&&"false"==this.strValue},Token$$1.prototype.isKeywordThis=function(){return this.type==TokenType.Keyword&&"this"==this.strValue},Token$$1.prototype.isError=function(){return this.type==TokenType.Error},Token$$1.prototype.toNumber=function(){return this.type==TokenType.Number?this.numValue:-1},Token$$1.prototype.toString=function(){switch(this.type){case TokenType.Character:case TokenType.Identifier:case TokenType.Keyword:case TokenType.Operator:case TokenType.String:case TokenType.Error:return this.strValue;case TokenType.Number:return this.numValue.toString();default:return null}},Token$$1}(),Scanner=(new Token$$1(-1,TokenType.Character,0,""),function(){function Scanner(input){this.input=input,this.peek=0,this.index=-1,this.length=input.length,this.advance()}return Scanner.prototype.advance=function(){this.peek=++this.index>=this.length?$EOF:this.input.charCodeAt(this.index)},Scanner.prototype.scanToken=function(){for(var input=this.input,length=this.length,peek=this.peek,index=this.index;$SPACE>=peek;){if(++index>=length){peek=$EOF;break}peek=input.charCodeAt(index)}if(this.peek=peek,this.index=index,index>=length)return null;if(isIdentifierStart(peek))return this.scanIdentifier();if(isDigit(peek))return this.scanNumber(index);var start=index;switch(peek){case $PERIOD:return this.advance(),isDigit(this.peek)?this.scanNumber(start):newCharacterToken(start,$PERIOD);case $LPAREN:case $RPAREN:case $LBRACE:case $RBRACE:case $LBRACKET:case $RBRACKET:case $COMMA:case $COLON:case $SEMICOLON:return this.scanCharacter(start,peek);case $SQ:case $DQ:return this.scanString();case $HASH:case $PLUS:case $MINUS:case $STAR:case $SLASH:case $PERCENT:case $CARET:return this.scanOperator(start,String.fromCharCode(peek));case $QUESTION:return this.scanComplexOperator(start,"?",$PERIOD,".");case $LT:case $GT:return this.scanComplexOperator(start,String.fromCharCode(peek),$EQ,"=");case $BANG:case $EQ:return this.scanComplexOperator(start,String.fromCharCode(peek),$EQ,"=",$EQ,"=");case $AMPERSAND:return this.scanComplexOperator(start,"&",$AMPERSAND,"&");case $BAR:return this.scanComplexOperator(start,"|",$BAR,"|");case $NBSP:for(;isWhitespace(this.peek);)this.advance();return this.scanToken()}return this.advance(),this.error("Unexpected character ["+String.fromCharCode(peek)+"]",0)},Scanner.prototype.scanCharacter=function(start,code){return this.advance(),newCharacterToken(start,code)},Scanner.prototype.scanOperator=function(start,str){return this.advance(),newOperatorToken(start,str)},Scanner.prototype.scanComplexOperator=function(start,one,twoCode,two,threeCode,three){this.advance();var str=one;return this.peek==twoCode&&(this.advance(),str+=two),null!=threeCode&&this.peek==threeCode&&(this.advance(),str+=three),newOperatorToken(start,str)},Scanner.prototype.scanIdentifier=function(){var start=this.index;for(this.advance();isIdentifierPart(this.peek);)this.advance();var str=this.input.substring(start,this.index);return KEYWORDS.indexOf(str)>-1?newKeywordToken(start,str):newIdentifierToken(start,str)},Scanner.prototype.scanNumber=function(start){var simple=this.index===start;for(this.advance();;){if(isDigit(this.peek));else if(this.peek==$PERIOD)simple=!1;else{if(!isExponentStart(this.peek))break;if(this.advance(),isExponentSign(this.peek)&&this.advance(),!isDigit(this.peek))return this.error("Invalid exponent",-1);simple=!1}this.advance()}var str=this.input.substring(start,this.index),value=simple?NumberWrapper.parseIntAutoRadix(str):parseFloat(str);return newNumberToken(start,value)},Scanner.prototype.scanString=function(){var start=this.index,quote=this.peek;this.advance();for(var buffer="",marker=this.index,input=this.input;this.peek!=quote;)if(this.peek==$BACKSLASH){buffer+=input.substring(marker,this.index),this.advance();var unescapedCode=void 0;if(this.peek=this.peek,this.peek==$u){var hex=input.substring(this.index+1,this.index+5);if(!/^[0-9a-f]+$/i.test(hex))return this.error("Invalid unicode escape [\\u"+hex+"]",0);unescapedCode=parseInt(hex,16);for(var i=0;5>i;i++)this.advance()}else unescapedCode=unescape(this.peek),this.advance();buffer+=String.fromCharCode(unescapedCode),marker=this.index}else{if(this.peek==$EOF)return this.error("Unterminated quote",0);this.advance()}var last=input.substring(marker,this.index);return this.advance(),newStringToken(start,buffer+last)},Scanner.prototype.error=function(message,offset){var position=this.index+offset;return newErrorToken(position,"Lexer Error: "+message+" at column "+position+" in expression ["+this.input+"]")},Scanner}()),Expression=function(){function Expression(tokens){this.tokens=tokens}return Expression}(),BIND_NAME_REGEXP=/^(?:(?:(?:(bind-)|(let-)|(ref-|#)|(on-)|(bindon-)|(@))(.+))|\[\(([^\)]+)\)\]|\[([^\]]+)\]|\(([^\)]+)\))$/,KW_BIND_IDX=1,KW_REF_IDX=3,KW_ON_IDX=4,KW_BINDON_IDX=5,KW_AT_IDX=6,IDENT_KW_IDX=7,IDENT_BANANA_BOX_IDX=8,IDENT_PROPERTY_IDX=9,IDENT_EVENT_IDX=10,BindingParser=function(){function BindingParser(_exprParser){this._exprParser=_exprParser}return BindingParser.prototype.parse=function(name,expression){var bindParts=name.match(BIND_NAME_REGEXP),expr=this._exprParser.parse(expression);if(isPresent(bindParts[KW_BIND_IDX]))unsupported("Property binding",name,expression);else if(bindParts[KW_REF_IDX])unsupported("Variable declaration",name,expression);else{if(bindParts[KW_ON_IDX])return new EventBindingParseResult(bindParts[IDENT_KW_IDX],expr);if(bindParts[KW_BINDON_IDX])unsupported("Two way binding",name,expression);else if(bindParts[KW_AT_IDX])unsupported("Animations",name,expression);else if(bindParts[IDENT_BANANA_BOX_IDX])unsupported("Two way binding",name,expression);else{if(!bindParts[IDENT_PROPERTY_IDX]){if(bindParts[IDENT_EVENT_IDX])return new EventBindingParseResult(bindParts[IDENT_EVENT_IDX],expr);throw new Error("Unknown binding name: "+name)}unsupported("Property binding",name,expression)}}},BindingParser}();BindingParser.decorators=[{type:mojiitoCore.Injectable}],BindingParser.ctorParameters=function(){return[{type:ExpressionParser$$1}]};var BindingParseResult=function(){function BindingParseResult(expression){this.expression=expression}return BindingParseResult}(),EventBindingParseResult=function(_super){function EventBindingParseResult(eventName,expression){var _this=_super.call(this,expression)||this;return _this.eventName=eventName,_this}return __extends(EventBindingParseResult,_super),EventBindingParseResult}(BindingParseResult),Compiler=function(){function Compiler(_resolver,_bindParser){this._resolver=_resolver,this._bindParser=_bindParser,this._compileResults=new Map}return Compiler.prototype.createComponentFactoryResolver=function(){var factories=[];return this._compileResults.forEach(function(summary){factories.push(summary.componentFactory)}),new mojiitoCore.ComponentFactoryResolver(factories)},Compiler.prototype.compileComponents=function(components){var _this=this;return components.map(function(c){return _this.compileComponent(c)})},Compiler.prototype.compileComponent=function(component){var compileSummary=this._compileResults.get(component);if(compileSummary)return compileSummary;var childComponents,rendererType,metadata=this._resolver.resolve(component);metadata.components&&(childComponents=this.compileComponents(ListWrapper.flatten(metadata.components)),rendererType=this._createComponentRendererType(new DomVisitor(childComponents)));var viewDefinitionFactory=this._createComponentViewDef(component,metadata.providers,rendererType),componentFactory=mojiitoCore.createComponentFactory(metadata.selector,component,viewDefinitionFactory);return compileSummary={type:component,selector:metadata.selector,hostListeners:metadata.host,childListeners:metadata.childs,componentFactory:componentFactory,viewDefinitionFactory:viewDefinitionFactory,components:childComponents},this._compileResults.set(component,compileSummary),compileSummary},Compiler.prototype._createProviderNodes=function(providers,nodes,nodeType){var nodeDefs=mojiitoCore.resolveReflectiveProviders(ListWrapper.flatten(providers)).map(function(provider,index){var factory=provider.resolvedFactories[0],node={flags:nodeType,index:nodes.length+index,provider:{token:provider.key.token,tokenKey:provider.key.displayName,factory:factory.factory,deps:factory.dependencies.map(function(dep){var flags=0;return dep.optional&&(flags+=2),dep.visibility instanceof mojiitoCore.SkipSelf&&(flags+=1),{flags:flags,token:dep.key.token,tokenKey:dep.key.displayName}})}};return node});return nodes.push.apply(nodes,nodeDefs),nodeDefs},Compiler.prototype._createComponentRendererType=function(visitor){return{visitor:visitor,data:null}},Compiler.prototype._createComponentViewDef=function(component,providers,componentRendererType){var _this=this,viewDefinitionFactory=function(){var nodes=[],nodeFlags=16777216,publicProviders={};providers&&(_this._createProviderNodes(providers,nodes,128).forEach(function(node){publicProviders[node.provider.tokenKey]=node}),nodeFlags|=128),_this._createProviderNodes([component],nodes,16384);var componentProvider=nodes[nodes.length-1];nodeFlags|=16384;var allProviders=publicProviders;return allProviders[componentProvider.provider.tokenKey]=componentProvider,{factory:viewDefinitionFactory,nodeFlags:nodeFlags,nodes:nodes,componentProvider:componentProvider,publicProviders:publicProviders,allProviders:allProviders,componentRendererType:componentRendererType}};return viewDefinitionFactory},Compiler}();Compiler.decorators=[{type:mojiitoCore.Injectable}],Compiler.ctorParameters=function(){return[{type:mojiitoCore.ComponentResolver},{type:BindingParser}]};var BrowserPlatformRef=function(_super){function BrowserPlatformRef(_injector,_resolver,_compiler){var _this=_super.call(this)||this;return _this._injector=_injector,_this._resolver=_resolver,_this._compiler=_compiler,_this._destroyed=!1,_this._destroyListeners=[],_this}return __extends(BrowserPlatformRef,_super),Object.defineProperty(BrowserPlatformRef.prototype,"injector",{get:function(){return this._injector},enumerable:!0,configurable:!0}),Object.defineProperty(BrowserPlatformRef.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),BrowserPlatformRef.prototype.bootstrapComponent=function(component){var _this=this;this._compiler.compileComponents([component]);var appInjector=mojiitoCore.ReflectiveInjector.resolveAndCreate([{provide:mojiitoCore.ComponentFactoryResolver,useFactory:function(){return _this._compiler.createComponentFactoryResolver()}},mojiitoCore.ApplicationRef],this._injector),app=appInjector.get(mojiitoCore.ApplicationRef);app.bootstrap(component)},BrowserPlatformRef.prototype.onDestroy=function(callback){this._destroyListeners.push(callback)},BrowserPlatformRef.prototype.destroy=function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._destroyListeners.forEach(function(listener){return listener()}),this._destroyed=!0},BrowserPlatformRef}(mojiitoCore.PlatformRef);BrowserPlatformRef.decorators=[{type:mojiitoCore.Injectable}],BrowserPlatformRef.ctorParameters=function(){return[{type:mojiitoCore.Injector},{type:mojiitoCore.ComponentResolver},{type:Compiler}]};var DOCUMENT=new mojiitoCore.InjectionToken("DocumentToken"),DomTraverser=function(){function DomTraverser(){this._nodeCount=0,this._elementCount=0,this._attributeCount=0,this._textCount=0,this._commentCount=0}return DomTraverser.prototype.traverse=function(node,visitor,context){void 0===context&&(context=null);var lclCntxt=context;if(this._nodeCount++,node instanceof Element?(lclCntxt=visitor.visitElement(node,lclCntxt)||lclCntxt,this._elementCount++):node instanceof Text?(lclCntxt=visitor.visitText(node,lclCntxt)||lclCntxt,this._textCount++):node instanceof Comment&&(lclCntxt=visitor.visitComment(node,lclCntxt)||lclCntxt,this._commentCount++),lclCntxt&&lclCntxt!==context){var rendererType=lclCntxt.def.componentRendererType;rendererType&&(visitor=rendererType.visitor)}else if(node instanceof Element&&node.attributes.length)for(var i=0,max=node.attributes.length;max>i;i++)lclCntxt=visitor.visitAttribute(node,node.attributes[i],lclCntxt)||lclCntxt,this._attributeCount++;var childNode=node.firstChild;if(childNode)for(this.traverse(childNode,visitor,lclCntxt);childNode=childNode.nextSibling;)this.traverse(childNode,visitor,lclCntxt)},DomTraverser}(),NAMESPACE_URIS={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xml:"http://www.w3.org/XML/1998/namespace"},DomRendererFactory=function(){function DomRendererFactory(){this.rendererByCompId=new Map,this.defaultRenderer=new DefaultDomRenderer}return DomRendererFactory.prototype.createRenderer=function(element,type){return element&&type?new ParseableDomRenderer(type.visitor,element):this.defaultRenderer},DomRendererFactory}();DomRendererFactory.decorators=[{type:mojiitoCore.Injectable}],DomRendererFactory.ctorParameters=function(){return[]};var DefaultDomRenderer=function(){function DefaultDomRenderer(){}return DefaultDomRenderer.prototype.parse=function(){throw new Error("Parse is not allowed on the DefaultDomRenderer!")},DefaultDomRenderer.prototype.destroy=function(){},DefaultDomRenderer.prototype.createElement=function(name,namespace){return namespace?document.createElementNS(NAMESPACE_URIS[namespace],name):document.createElement(name)},DefaultDomRenderer.prototype.createComment=function(value){return document.createComment(value)},DefaultDomRenderer.prototype.createText=function(value){return document.createTextNode(value)},DefaultDomRenderer.prototype.destroyNode=function(){},DefaultDomRenderer.prototype.appendChild=function(parent,newChild){parent.appendChild(newChild)},DefaultDomRenderer.prototype.insertBefore=function(parent,newChild,refChild){parent&&parent.insertBefore(newChild,refChild)},DefaultDomRenderer.prototype.removeChild=function(parent,oldChild){parent&&parent.removeChild(oldChild)},DefaultDomRenderer.prototype.selectRootElement=function(selectorOrNode){var el=selectorOrNode;if("string"==typeof selectorOrNode&&(el=document.querySelector(selectorOrNode)),!el)throw new Error('The selector "'+selectorOrNode+'" did not match any elements');return el},DefaultDomRenderer.prototype.parentNode=function(node){return node.parentNode},DefaultDomRenderer.prototype.nextSibling=function(node){return node.nextSibling},DefaultDomRenderer.prototype.setAttribute=function(el,name,value,namespace){namespace?el.setAttributeNS(NAMESPACE_URIS[namespace],namespace+":"+name,value):el.setAttribute(name,value);

},DefaultDomRenderer.prototype.removeAttribute=function(el,name,namespace){namespace?el.removeAttributeNS(NAMESPACE_URIS[namespace],name):el.removeAttribute(name)},DefaultDomRenderer.prototype.addClass=function(el,name){el.classList.add(name)},DefaultDomRenderer.prototype.removeClass=function(el,name){el.classList.remove(name)},DefaultDomRenderer.prototype.setStyle=function(el,style,value,hasVendorPrefix,hasImportant){hasVendorPrefix||hasImportant?el.style.setProperty(style,value,hasImportant?"important":""):el.style[style]=value},DefaultDomRenderer.prototype.removeStyle=function(el,style,hasVendorPrefix){hasVendorPrefix?el.style.removeProperty(style):el.style[style]=""},DefaultDomRenderer.prototype.setProperty=function(el,name,value){el[name]=value},DefaultDomRenderer.prototype.setValue=function(node,value){node.nodeValue=value},DefaultDomRenderer.prototype.listen=function(target,event,callback){if("string"==typeof target&&(target=getGlobalEventTarget(target),!target))throw new Error("Unsupported event target "+target+" for event "+event);return target.addEventListener(event,callback,!1),function(){return target.removeEventListener(event,callback,!1)}},DefaultDomRenderer}(),ParseableDomRenderer=function(_super){function ParseableDomRenderer(_visitor,hostElement){var _this=_super.call(this)||this;return _this._visitor=_visitor,_this.hostElement=hostElement,_this}return __extends(ParseableDomRenderer,_super),ParseableDomRenderer.prototype.parse=function(context){var traverser=new DomTraverser;traverser.traverse(this.hostElement,this._visitor,context)},ParseableDomRenderer.prototype.destroyNode=function(node){node instanceof Node&&this.removeChild(node.parentNode,node)},ParseableDomRenderer}(DefaultDomRenderer),PLATFORM_PROVIDERS=[{provide:mojiitoCore.PlatformRef,useClass:BrowserPlatformRef},{provide:DOCUMENT,useValue:document},{provide:mojiitoCore.RendererFactory,useClass:DomRendererFactory},Compiler,ExpressionParser$$1,BindingParser],platformBrowser=mojiitoCore.createPlatformFactory([PLATFORM_PROVIDERS,mojiitoCore.CORE_PROVIDERS]);exports.DOCUMENT=DOCUMENT,exports.DomRendererFactory=DomRendererFactory,exports.BrowserPlatformRef=BrowserPlatformRef,exports.ExpressionParser=ExpressionParser$$1,exports.PLATFORM_PROVIDERS=PLATFORM_PROVIDERS,exports.platformBrowser=platformBrowser,exports.ɵb=BindingParser,exports.ɵa=Compiler,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=platform-browser.umd.min.js.map
